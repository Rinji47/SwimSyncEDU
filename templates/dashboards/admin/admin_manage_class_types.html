{% extends 'base.html' %}
{% load static %}

{% block title %}Manage Class Types - SwimSync EDU{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">
<link rel="stylesheet" href="{% static 'css/admin_manage.css' %}">
{% endblock %}

{% block content %}


<div class="dashboard-layout">
    {% include "./components/admin_sidebar.html" %}

    <main class="dashboard-main">
        {% include "../../components/message.html" %}
        <div class="dashboard-header">
            <h1>Class Types</h1>
            <button class="btn-primary" onclick="toggleModal('classTypeModal')">Add Class Type</button>
        </div>

        <div class="dashboard-section">
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Description</th>
                            <th>Cost</th>
                            <th>Is Closed</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for type in class_types %}
                        <tr>
                            <td>{{ type.name }}</td>
                            <td>{{ type.description }}</td>
                            <td>${{ type.cost }}</td>
                            <td>
                                {% if type.is_closed %}
                                    <span class="status-closed">Closed</span>
                                {% else %}
                                    <span class="status-open">Open</span>
                                {% endif %}
                            </td>
                            <td>
                                <button class="btn-sm btn-secondary"
                                onclick="openEditClassTypeModal(this)"
                                    data-url="{% url 'edit_class_types' type.class_type_id %}"
                                    data-class-type='{
                                        "name": "{{ type.name }}",
                                        "description": "{{ type.description }}",
                                        "cost": "{{ type.cost }}",
                                        "is_closed": "{{ type.is_closed }}"
                                    }'
                                >Edit</button>
                                <button class="btn-sm btn-danger">
                                    <a href="{% url 'close_class_type' type.class_type_id %}" style="text-decoration: none; color: white;"
                                    onclick="return confirm('Are you sure you want to close this class type?');">Close</a>
                                </button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </main>
</div>

<!-- Modal -->
<div id="classTypeModal" class="modal">
    <div class="modal-content">
        <div class="modal-header">
            <h2>Add Class Type</h2>
            <span class="close" onclick="toggleModal('classTypeModal')">&times;</span>
        </div>
        <form method="POST">
            {% csrf_token %}
            <div class="form-group">
                <label for="type_name">Name</label>
                <input type="text" id="type_name" name="name" required>
            </div>
            <div class="form-group">
                <label for="cost">Cost ($)</label>
                <input type="number" step="0.01" id="cost" name="cost" required>
            </div>
            <div class="form-group">
                <label for="description">Description</label>
                <textarea id="description" name="description" rows="4"></textarea>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-secondary" onclick="toggleModal('classTypeModal')">Cancel</button>
                <button type="submit" class="btn-primary">Save Type</button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
